a lot of the code came from https://github.com/nkr685
